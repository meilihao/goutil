package crypto

import (
	"testing"
)

func TestAESCBC(t *testing.T) {
	key := []byte{
		0x01, 0x21, 0x02, 0x03, 0x04, 0x05, 0x26, 0x05,
		0x02, 0x09, 0x3a, 0xbb, 0xac, 0x0d, 0x0e, 0x06,
		0x03, 0x1a, 0x32, 0x13, 0x34, 0x15, 0xf6, 0x07,
		0x04, 0x13, 0x1a, 0x1b, 0x1c, 0xdd, 0x1e, 0x08,
	}

	origin := "this is a test"
	c, err := AESEncrypt(key, []byte(origin))
	if err != nil {
		t.Fatal(err)
	}

	p, err := AESDecrypt(key, c)
	if err != nil {
		t.Fatal(err)
	}
	if string(p) != origin {
		t.Errorf("aes cbc impl error")
	}
}
